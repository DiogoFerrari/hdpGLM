<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hierarchical Dirichlet Process Generalized Linear Models • hdpGLM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Hierarchical Dirichlet Process Generalized Linear Models">
<meta property="og:description" content="Implementation of MCMC algorithms to estimate the Hierarchical Dirichlet Process Generalized Linear Model (hdpGLM) presented in the paper Ferrari (2020) Modeling Context-Dependent Latent Heterogeneity, Political Analysis &lt;DOI:10.1017/pan.2019.13&gt; and &lt;doi:10.18637/jss.v107.i10&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hdpGLM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/hdpGLM.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://www.cambridge.org/core/journals/political-analysis/article/modeling-contextdependent-latent-effect-heterogeneity/B7B0AF067DF97A1A8F0B50646EF64F24" class="external-link">Paper</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DiogoFerrari/hdpGLM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="hdpglm-">hdpGLM <img src="reference/figures/hdpGLM_logo.png" align="right" height="139" style="float:right; height:139px;"><a class="anchor" aria-label="anchor" href="#hdpglm-"></a>
</h1></div>
<p><a href="https://cran.r-project.org/package=hdpGLM" class="external-link"><img src="https://www.r-pkg.org/badges/version/hdpGLM?color=green" alt="CRAN status"></a></p>
</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p>The package implements the hierarchical Dirichlet process Generalized Linear Models proposed in the paper Modeling Context-Dependent Latent Effect Heterogeneity. The model can be used to estimate latent heterogeneity in the marginal effect of GLM linear coefficients, cluster data points based on that latent heterogeneity, and investigate if Simpson’s Paradox occurs due to latent or omitted features. It also can be used with hierarchical data to estimate the effect of upper-level covariates on the latent heterogeneity in the effect of lower-level features.</p>
<p>For details of the model and the MCMC algorithm, see Ferrari, D. (2020) <a href="https://www.cambridge.org/core/journals/political-analysis/article/modeling-contextdependent-latent-effect-heterogeneity/B7B0AF067DF97A1A8F0B50646EF64F24" class="external-link">Modeling Context-Dependent Latent Effect Heterogeneity</a>, <a href="https://www.cambridge.org/core/journals/political-analysis" class="external-link">Political Analysis</a>, Volume 28, Issue 1, January, pp. 20-46. &lt;DOI: 10.1017/pan.2019.13&gt;.</p>
</div>
<div class="section level1">
<h1 id="instalation">Instalation<a class="anchor" aria-label="anchor" href="#instalation"></a>
</h1>
<pre><code><span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"DiogoFerrari/hdpGLM"</span><span class="op">)</span></span>
<span><span class="co"># If you don't want to update the dependencies, use: (you may need to install some dependencies manually)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"DiogoFerrari/hdpGLM"</span>, dependencies<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre>
<p>NOTE: it may be necessary to create a token to install the package from the git repository in case it is private (see note at the bottom of help page in R by running <code>help(install_github)</code>).</p>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<p>Here is a simple example of how to use the package:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DiogoFerrari/hdpGLM" class="external-link">hdpGLM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example for the dpGLM (no hierarchical structure)</span></span>
<span><span class="co">## -------------- ------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">K</span>    <span class="op">=</span> <span class="fl">3</span> <span class="co"># number of latent clusters</span></span>
<span><span class="va">nCov</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># number of observed covariates</span></span>
<span><span class="va">simdata</span> <span class="op">=</span> <span class="fu"><a href="reference/hdpGLM_simulateData.html">hdpGLM_simulateData</a></span><span class="op">(</span><span class="fl">400</span>, nCov<span class="op">=</span><span class="va">nCov</span>, K<span class="op">=</span><span class="va">K</span>, family<span class="op">=</span><span class="st">'gaussian'</span><span class="op">)</span></span>
<span><span class="va">data</span>    <span class="op">=</span> <span class="va">simdata</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">mcmc</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>burn.in<span class="op">=</span><span class="fl">1</span>, n.iter<span class="op">=</span><span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">=</span> <span class="fu"><a href="reference/hdpGLM.html">hdpGLM</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">data</span>, mcmc<span class="op">=</span><span class="va">mcmc</span>, n.display<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/classify.html">classify</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span>, terms<span class="op">=</span><span class="st">"X1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span>, separate<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span>, true.beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span>, true.beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span><span class="op">$</span><span class="va">beta</span>, separate<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example for the hdpGLM (with hierarchical structure)</span></span>
<span><span class="co">## -------------- -------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6667</span><span class="op">)</span></span>
<span><span class="va">simdata</span> <span class="op">=</span> <span class="fu"><a href="reference/hdpGLM_simulateData.html">hdpGLM_simulateData</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">3</span>, <span class="fl">2</span>, nCovj<span class="op">=</span><span class="fl">2</span>, J<span class="op">=</span><span class="fl">4</span>, family<span class="op">=</span><span class="st">'gaussian'</span><span class="op">)</span></span>
<span><span class="va">data</span>    <span class="op">=</span> <span class="va">simdata</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">mcmc</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>burn.in<span class="op">=</span><span class="fl">1</span>, n.iter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">=</span> <span class="fu"><a href="reference/hdpGLM.html">hdpGLM</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>, <span class="va">y</span><span class="op">~</span><span class="va">W1</span><span class="op">+</span><span class="va">W2</span>, data<span class="op">=</span><span class="va">data</span>, mcmc<span class="op">=</span><span class="va">mcmc</span>, n.display<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/classify.html">classify</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samples</span>, terms <span class="op">=</span> <span class="st">'X1'</span>, j.idx<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_hdpglm.html">plot_hdpglm</a></span><span class="op">(</span><span class="va">samples</span>, ncol.tau<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_tau.html">plot_tau</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_tau.html">plot_tau</a></span><span class="op">(</span><span class="va">samples</span>, X<span class="op">=</span><span class="st">'X1'</span><span class="op">)</span></span></code></pre>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=hdpGLM" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/DiogoFerrari/hdpGLM/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/DiogoFerrari/hdpGLM/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hdpGLM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://diogoferrari.com" class="external-link">Diogo Ferrari</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://diogoferrari.com" class="external-link">Diogo Ferrari</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
